version: '2'

networks:
  hbase:

services:
  jvm:
    image: karlstoney/jvm
 
  hbase:
    image: karlstoney/hbase
    hostname: hbase
    container_name: hbase
    restart: always
    networks:
      hbase:
    depends_on:
      - jvm
      - namenode
      - datanode1
      - datanode2
    ports:
      - 8080:8080   # Rest
      - 9090:9090   # Thrift API
      - 9095:9095   # Thrift UI
      - 2181:2181   # Zookeeper 
      - 16000:16000 # Master API
      - 16010:16010 # Master UI
      - 16020:16020 # Region API
      - 16030:16030 # Region UI
    environment:
      - QUORUM=hbase

  hue:
    image: karlstoney/hue
    hostname: hue
    container_name: hue
    restart: always
    networks:
      - hbase
    depends_on:
      - hbase
    ports:
      - 8888:8888
       
  namenode:
    image: karlstoney/namenode 
    hostname: namenode
    container_name: namenode
    networks:
      - hbase
    depends_on:
      - datanode1
      - datanode2
    ports:
      - 50070:50070
      - 8020:8020
    env_file:
      - ./hadoop.env
    environment:
      - CLUSTER_NAME=test

  datanode1:
    image: karlstoney/datanode 
    hostname: datanode1
    container_name: datanode1
    networks:
      - hbase
    depends_on:
      - jvm
    env_file:
      - ./hadoop.env

  datanode2:
    image: karlstoney/datanode 
    hostname: datanode2
    container_name: datanode2
    networks: 
      - hbase
    env_file:
      - ./hadoop.env
